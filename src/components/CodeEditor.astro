---
interface Props {
  initialLanguage?: string;
}

const { initialLanguage = "en" } = Astro.props;
---

<div class="relative bg-[#1E1E1E] rounded-xl shadow-xl border border-gray-800">
  <!-- Editor Header -->
  <div class="flex items-center justify-between px-4 py-2 bg-[#252526] rounded-t-xl border-b border-gray-800">
    <!-- Window Controls and File Tab -->
    <div class="flex items-end space-x-2">
      <div class="flex items-center space-x-2">
        <div class="h-3 w-3 rounded-full bg-red-400"></div>
        <div class="h-3 w-3 rounded-full bg-brand-yellow"></div>
        <div class="h-3 w-3 rounded-full bg-emerald-400"></div>
      </div>
      <div class="px-3 py-1 bg-[#1E1E1E] rounded-t-md border border-gray-800 border-b-0 -mb-2">
        <span class="text-xs text-gray-400 font-noto-mono" id="file-name">welcome_user.py</span>
      </div>
    </div>

    <!-- Language Indicator -->
    <div class="flex items-center space-x-2">
      <div class="px-2 py-1 bg-[#2D2D2D] rounded-md">
        <div class="text-xs text-gray-400 font-noto-mono" id="language-indicator">English</div>
      </div>
    </div>
  </div>
  
  <!-- Editor Content -->
  <div class="p-6">
    <div class="space-y-2 font-noto-mono text-sm">
      <div class="flex">
        <div class="text-purple-400" id="func-keyword">def</div>
        <div class="text-blue-400 pl-1" id="func-name">welcome_user</div>
        <div class="text-red-400">(</div>
        <div class="text-red-300" id="param-name">name</div>
        <div class="text-gray-400">:</div>
        <div class="text-purple-400" id="type-hint">str</div>
        <div class="text-red-400">)</div>
        <div class="text-gray-400">:</div>
      </div>
      <div class="flex pl-4">
        <div class="text-green-400" id="docstring">"""</div>
      </div>
      <div class="flex pl-4">
        <div class="text-green-400" id="docstring-text">This function welcomes the user by name. If the user's name is not provided, the function will ask the user for their name.</div>
      </div>
      <div class="flex pl-4">
        <div class="text-green-400" id="docstring-end">"""</div>
      </div>
      <div class="flex pl-4">
        <div class="text-gray-400" id="comment"># Ask the user for their name</div>
      </div>
      <div class="flex pl-4">
        <div class="text-red-300" id="var-name">name</div>
        <div class="text-teal-400 pl-1"> = </div>
        <div class="text-blue-400" id="input-func">input</div>
        <div class="text-red-400">(</div>
        <div class="text-green-400">"</div>
        <div class="text-green-400" id="prompt-text">What's your name? </div>
        <div class="text-green-400">"</div>
        <div class="text-red-400">)</div>
      </div>
      <div class="flex pl-4">
        <div class="text-gray-400" id="comment-2"># Print a welcome message</div>
      </div>
      <div class="flex pl-4">
        <div class="text-blue-400" id="print-keyword">print</div>
        <div class="text-red-400">(</div>
        <div class="text-green-400" id="f-string">f</div>
        <div class="text-green-400" id="welcome-text">"
          <span id="welcome-prefix" class="text-content">Hello, </span>
          <span class="text-orange-400 syntax">&#123;</span>
          <span class="text-red-300 syntax" id="f-string-var">name</span>
          <span class="text-orange-400 syntax">&#125;</span>
          <span id="welcome-suffix" class="text-content">! Welcome to Legesher!</span>
        "</div>
        <div class="text-red-400">)</div>
      </div>
      <div class="flex pl-4">
        <div class="text-gray-400" id="comment-3"># Return the user's name</div>
      </div>
      <div class="flex pl-4">
        <div class="text-purple-400" id="return-keyword">return</div>
        <div class="text-red-300 pl-1" id="return-var">name</div>
      </div>
      <div class="flex pl-4"></div>
      <div class="flex">
        <div class="text-yellow-300" id="username-declaration">userName</div>
        <div class="text-teal-400 pl-1">=</div>
        <div class="text-green-400" id="name-value">"Peggy"</div>
      </div>
      <div class="flex">
        <div class="text-blue-400" id="print-keyword-2">print</div>
        <div class="text-red-400">(</div>
        <div class="text-blue-400" id="func-call">welcome_user</div>
        <div class="text-orange-400">(</div>
        <div class="text-yellow-300" id="username-argument">userName</div>
        <div class="text-orange-400">)</div>
        <div class="text-red-400">)</div>
      </div>
    </div>
  </div>
</div>

<script>
  const languages = [
    {
      code: "es",
      displayName: "Español",
      fileName: "bienvenida_usuario.py",
      funcKeyword: "definir",
      funcName: "bienvenida_usuario",
      paramName: "nombre",
      typeHint: "str",
      docstring: "Esta función da la bienvenida al usuario por su nombre. Si no se proporciona el nombre del usuario, la función pedirá al usuario su nombre.",
      comment1: "# Preguntar al usuario su nombre",
      inputFunc: "entrada",
      promptText: "¿Cómo te llamas? ",
      comment2: "# Imprimir mensaje de bienvenida",
      printKeyword: "imprimir",
      fString: "f",
      welcomePrefix: "¡Hola, ",
      welcomeSuffix: "! ¡Bienvenido a Legesher!",
      comment3: "# Devolver el nombre del usuario",
      returnKeyword: "devolver",
      returnVar: "nombre",
      nameValue: "Peggy",
      userName: "nombreUsuario"
    },
    {
      code: "zh",
      displayName: "中文",
      fileName: "欢迎用户.py",
      funcKeyword: "定义",
      funcName: "欢迎用户",
      paramName: "名字",
      typeHint: "字符串",
      docstring: "此函数通过名字欢迎用户。如果未提供用户名字，函数将询问用户的名字。",
      comment1: "# 询问用户的名字",
      inputFunc: "输入",
      promptText: "你叫什么名字？",
      comment2: "# 打印欢迎信息",
      printKeyword: "打印",
      fString: "格",
      welcomePrefix: "你好，",
      welcomeSuffix: "！欢迎来到Legesher！",
      comment3: "# 返回用户的名字",
      returnKeyword: "返回",
      returnVar: "名字",
      nameValue: "佩吉",
      userName: "用户名"
    },
    {
      code: "ar",
      displayName: "العربية",
      fileName: "ترحيب_المستخدم.py",
      funcKeyword: "عرّف",
      funcName: "ترحيب_المستخدم",
      paramName: "الاسم",
      typeHint: "نص",
      docstring: "هذه الدالة ترحب بالمستخدم باسمه. إذا لم يتم تقديم اسم المستخدم، ستطلب الدالة من المستخدم إدخال اسمه.",
      comment1: "# اسأل المستخدم عن اسمه",
      inputFunc: "إدخال",
      promptText: "ما هو اسمك؟ ",
      comment2: "# اطبع رسالة الترحيب",
      printKeyword: "اطبع",
      fString: "ت",
      welcomePrefix: "مرحباً، ",
      welcomeSuffix: "! أهلاً بك في Legesher!",
      comment3: "# أرجع اسم المستخدم",
      returnKeyword: "أرجع",
      returnVar: "الاسم",
      nameValue: "بيغي",
      userName: "اسم_المستخدم"
    },
    {
      code: "en",
      displayName: "English",
      fileName: "welcome_user.py",
      funcKeyword: "def",
      funcName: "welcome_user",
      paramName: "name",
      typeHint: "str",
      docstring: "This function welcomes the user by name. If the user's name is not provided, the function will ask the user for their name.",
      comment1: "# Ask the user for their name",
      inputFunc: "input",
      promptText: "What's your name? ",
      comment2: "# Print a welcome message",
      printKeyword: "print",
      fString: "f",
      welcomePrefix: "Hello, ",
      welcomeSuffix: "! Welcome to Legesher!",
      comment3: "# Return the user's name",
      returnKeyword: "return",
      returnVar: "name",
      nameValue: "Peggy",
      userName: "userName"
    }
  ];

  interface CodeElements {
    languageIndicator: HTMLElement | null;
    fileName: HTMLElement | null;
    funcKeyword: HTMLElement | null;
    funcName: HTMLElement | null;
    paramName: HTMLElement | null;
    typeHint: HTMLElement | null;
    docstring: HTMLElement | null;
    docstringText: HTMLElement | null;
    docstringEnd: HTMLElement | null;
    comment1: HTMLElement | null;
    inputFunc: HTMLElement | null;
    promptText: HTMLElement | null;
    comment2: HTMLElement | null;
    printKeyword: HTMLElement | null;
    fString: HTMLElement | null;
    welcomeText: HTMLElement | null;
    comment3: HTMLElement | null;
    returnKeyword: HTMLElement | null;
    returnVar: HTMLElement | null;
    nameValue: HTMLElement | null;
    printKeyword2: HTMLElement | null;
    funcCall: HTMLElement | null;
    varName: HTMLElement | null;
    usernameDeclaration: HTMLElement | null;
    usernameArgument: HTMLElement | null;
    welcomePrefix: HTMLElement | null;
    welcomeSuffix: HTMLElement | null;
    fStringVar: HTMLElement | null;
  }

  let elements: CodeElements = {
    languageIndicator: null,
    fileName: null,
    funcKeyword: null,
    funcName: null,
    paramName: null,
    typeHint: null,
    docstring: null,
    docstringText: null,
    docstringEnd: null,
    comment1: null,
    inputFunc: null,
    promptText: null,
    comment2: null,
    printKeyword: null,
    fString: null,
    welcomeText: null,
    comment3: null,
    returnKeyword: null,
    returnVar: null,
    nameValue: null,
    printKeyword2: null,
    funcCall: null,
    varName: null,
    usernameDeclaration: null,
    usernameArgument: null,
    welcomePrefix: null,
    welcomeSuffix: null,
    fStringVar: null
  };

  let currentIndex = 0;

  function initializeElements() {
    elements = {
      languageIndicator: document.getElementById('language-indicator'),
      fileName: document.getElementById('file-name'),
      funcKeyword: document.getElementById('func-keyword'),
      funcName: document.getElementById('func-name'),
      paramName: document.getElementById('param-name'),
      typeHint: document.getElementById('type-hint'),
      docstring: document.getElementById('docstring'),
      docstringText: document.getElementById('docstring-text'),
      docstringEnd: document.getElementById('docstring-end'),
      comment1: document.getElementById('comment'),
      inputFunc: document.getElementById('input-func'),
      promptText: document.getElementById('prompt-text'),
      comment2: document.getElementById('comment-2'),
      printKeyword: document.getElementById('print-keyword'),
      fString: document.getElementById('f-string'),
      welcomeText: document.getElementById('welcome-text'),
      comment3: document.getElementById('comment-3'),
      returnKeyword: document.getElementById('return-keyword'),
      returnVar: document.getElementById('return-var'),
      nameValue: document.getElementById('name-value'),
      printKeyword2: document.getElementById('print-keyword-2'),
      funcCall: document.getElementById('func-call'),
      varName: document.getElementById('var-name'),
      usernameDeclaration: document.getElementById('username-declaration'),
      usernameArgument: document.getElementById('username-argument'),
      welcomePrefix: document.getElementById('welcome-prefix'),
      welcomeSuffix: document.getElementById('welcome-suffix'),
      fStringVar: document.getElementById('f-string-var')
    };
  }

  function updateText() {
    const lang = languages[currentIndex];
    
    // Fade out all elements
    Object.values(elements).forEach(el => {
      if (el) el.style.opacity = '0';
    });
    
    setTimeout(() => {
      // Update all elements
      if (elements.languageIndicator) elements.languageIndicator.textContent = lang.displayName;
      if (elements.fileName) {
        elements.fileName.textContent = lang.fileName;
        if (lang.code === "ar") {
          elements.fileName.style.direction = "rtl";
          document.querySelectorAll('.text-content').forEach(el => {
            (el as HTMLElement).style.direction = 'rtl';
          });
        } else {
          elements.fileName.style.direction = "ltr";
          document.querySelectorAll('.text-content').forEach(el => {
            (el as HTMLElement).style.direction = 'ltr';
          });
        }
      }
      if (elements.funcKeyword) elements.funcKeyword.textContent = lang.funcKeyword;
      if (elements.funcName) elements.funcName.textContent = lang.funcName;
      if (elements.paramName) elements.paramName.textContent = lang.paramName;
      if (elements.typeHint) elements.typeHint.textContent = lang.typeHint;
      if (elements.docstringText) elements.docstringText.textContent = lang.docstring;
      if (elements.comment1) elements.comment1.textContent = lang.comment1;
      if (elements.inputFunc) elements.inputFunc.textContent = lang.inputFunc;
      if (elements.promptText) elements.promptText.textContent = lang.promptText;
      if (elements.comment2) elements.comment2.textContent = lang.comment2;
      if (elements.printKeyword) elements.printKeyword.textContent = lang.printKeyword;
      if (elements.fString) elements.fString.textContent = lang.fString;
      if (elements.welcomePrefix) elements.welcomePrefix.textContent = lang.welcomePrefix;
      if (elements.welcomeSuffix) elements.welcomeSuffix.textContent = lang.welcomeSuffix;
      if (elements.comment3) elements.comment3.textContent = lang.comment3;
      if (elements.returnKeyword) elements.returnKeyword.textContent = lang.returnKeyword;
      if (elements.returnVar) elements.returnVar.textContent = lang.returnVar;
      if (elements.nameValue) elements.nameValue.textContent = lang.nameValue;
      if (elements.printKeyword2) elements.printKeyword2.textContent = lang.printKeyword;
      if (elements.funcCall) elements.funcCall.textContent = lang.funcName;
      if (elements.varName) elements.varName.textContent = lang.paramName;
      if (elements.usernameDeclaration) elements.usernameDeclaration.textContent = lang.userName;
      if (elements.usernameArgument) elements.usernameArgument.textContent = lang.userName;
      if (elements.welcomePrefix) elements.welcomePrefix.textContent = lang.welcomePrefix;
      if (elements.welcomeSuffix) elements.welcomeSuffix.textContent = lang.welcomeSuffix;
      if (elements.fStringVar) elements.fStringVar.textContent = lang.paramName;
      
      // Fade in all elements
      Object.values(elements).forEach(el => {
        if (el) el.style.opacity = '1';
      });
      
      // Move to next language
      currentIndex = (currentIndex + 1) % languages.length;
    }, 500);
  }

  // Wait for DOM to be fully loaded
  document.addEventListener('DOMContentLoaded', () => {
    initializeElements();
    
    // Initial delay before starting the animation
    setTimeout(() => {
      // Update text every 5 seconds
      setInterval(updateText, 5000);
    }, 2000);
  });
</script>

<style>
  #language-indicator, #file-name, #func-keyword, #func-name, #param-name, #type-hint, #docstring, #docstring-text, #docstring-end, #comment, #input-func, #prompt-text, #comment-2, #print-keyword, #f-string, #welcome-prefix, #welcome-suffix #comment-3, #return-keyword, #return-var, #name-value, #print-keyword-2, #func-call, #var-name, #username-declaration, #username-argument {
    transition: opacity 0.5s ease-in-out;
  }

  .syntax {
    direction: ltr !important;
    display: inline-block;
  }

  .text-content {
    display: inline-block;
  }
</style> 